---
title: "Suicide Data Analysis Project"
author: "Stats Stars"
date: "04/29/19"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Your project goes here! Before you submit, make sure your chunks are turned off with `echo = FALSE`. 

You can add sections as you see fit. Make sure you have a section called Introduction at the beginning and a section called Conclusion at the end. The rest is up to you!

### Introduction

### Load Data and Libraries

```{r load-data, message=FALSE}
library(tidyverse)
suicides <- read_csv("/cloud/project/data/master.csv")
```

### Suicides and Location

### Suicides and Economic Situation

```{r create-dataframe-grouping-data-countryyear}
#aggregated all the suicides/100k pop data per country-year
suicides_grouped <- aggregate(`suicides/100k pop` ~ `country-year`, data = suicides, FUN=sum)

#merged data set created with old one to have access to gdp data
suicide_economics <- merge(suicides, suicides_grouped, by.x = "country-year", by.y = "country-year") %>%
  select(`country-year`, `suicides/100k pop.y`, `gdp_per_capita ($)`)
```

```{r vis-suicide-gdp-per-capita}
ggplot(data = suicide_economics, mapping = aes(x = `gdp_per_capita ($)`, y = `suicides/100k pop.y`)) + 
  geom_point(size = 0.1, color = "blue") +
  labs(title = "Suicides per 100k of the population vs. GDP per capita",
       x = "GDP per capita ($)",
       y = "Suicides per 100k of the population")
```

### Suicides and Generation/Age

### Suicides and Year

Group number of suicides together by year to find number of suicides for each year:

```{r year-suicides}
year_suicides<- suicides %>%
  group_by(year) %>% 
  count(suicides_no) %>%
  summarize(n = sum(n))
```

Create visualization to represent the number of suicides for each year:

```{r year-suicides-visualization}
ggplot(data = year_suicides, mapping=aes(x = year, y =  n)) + geom_col()  +  labs(title = "Number of Suicides for Each Year", x = "Year", y = "Number of Suicides")
```

### Suicides and Sex

Group number of suicides together by sex to find number of suicides for each sex:

```{r sex-suicide}
suicides_sex <- suicides %>%
  group_by(sex) %>% 
  count(suicides_no) %>%
  summarize(n = sum(n))
```

Create visualization to represent the number of suicides for each year:

```{r sex-suicides-visualization}
ggplot(data = suicides_sex, mapping=aes(x = sex, y =  n)) + geom_col()  +  labs(title = "Number of Suicides for Each Sex", x = "Sex", y = "Number of Suicides")
```

Compare number of suicides for each sex per year:

```{r year-sex-suicides}
year_sex <- suicides %>%
  group_by(year, sex) %>% 
  count(suicides_no) %>%
  summarize(n = sum(n))

year_sex
```

```{r year-sex-visualization}
ggplot(data = year_sex, mapping=aes(x = year, fill = sex)) + geom_bar(position = "fill")  +  labs(title = "Proportions of Gender for Births in 2010-2017", x = "Generation", y = "Number of Births")
```



### Linear Modeling 

### Conclusion